<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>{{ 'seller.home.dailyRoute' | translate }}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form class="form-container" novalidate>

    <ion-card class="input-card">
      <ion-card-header>
        <ion-card-title>{{ 'seller.clientVisit.visitDateTimeLabel' | translate }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-datetime
          [(ngModel)]="selectedDate"
          name="visitDate"
          presentation="date"
          required
          [min]="minDate"
          [locale]="locale"
          prefer-wheel="false"
          hour-cycle="h23"
          (ionChange)="onDateSelected()">
        </ion-datetime>
      </ion-card-content>
    </ion-card>

    <ion-card class="map-card">
      <ion-card-header>
        <ion-card-title>{{ 'client.dailyRoute.mapAriaLabel' | translate }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <div
          class="map-container"
          role="region"
          [attr.aria-label]="'client.dailyRoute.mapAriaLabel' | translate">
          
          <div #leafletMap id="leafletMap" class="leaflet-map"></div>

          <ion-spinner *ngIf="loadingMap" name="crescent" class="spinner-center"></ion-spinner>
        </div>
      </ion-card-content>
    </ion-card>

    <ion-card class="client-list-card" *ngIf="filteredClients.length > 0">
      <ion-card-header>
        <ion-card-title>{{ 'seller.assignedClients.listTitle' | translate }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngFor="let client of filteredClients">
            <ion-avatar slot="start">
              <ion-icon name="person-circle-outline" size="large"></ion-icon>
            </ion-avatar>
            <ion-label>
              <strong>{{ client.full_name }}</strong><br />
              <small>{{ client.address }}</small>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-text color="medium" *ngIf="filteredClients.length === 0">
      <p class="empty-message">{{ 'client.dailyRoute.noClients' | translate }}</p>
    </ion-text>

    <div class="reorder-button">
      <ion-button expand="block" (click)="reorderClients()" [disabled]="!selectedDate">
        {{ 'seller.dailyRoute.reorderButton' | translate }}
      </ion-button>
    </div>

    <ion-card>
      <ion-card-header>
        <ion-card-title>{{ 'seller.dailyRoute.recommendationsTitle' | translate }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-list lines="none">
          <ion-item>
            <ion-icon name="checkmark-circle-outline" slot="start" color="success"></ion-icon>
            <ion-label>{{ 'seller.dailyRoute.recommendation1' | translate }}</ion-label>
          </ion-item>
          <ion-item>
            <ion-icon name="checkmark-circle-outline" slot="start" color="success"></ion-icon>
            <ion-label>{{ 'seller.dailyRoute.recommendation2' | translate }}</ion-label>
          </ion-item>
          <ion-item>
            <ion-icon name="checkmark-circle-outline" slot="start" color="success"></ion-icon>
            <ion-label>{{ 'seller.dailyRoute.recommendation3' | translate }}</ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

  </form>
</ion-content>
